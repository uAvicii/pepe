import{_ as z}from"./CpIcon-bf619351.js";import{d as E,z as J,A as q,u as G,b as K,r as f,v as I,e as d,f as U,g as V,i as a,h as e,j as r,w as o,l as A,t as s,F as Q,B as W,J as X,C as k,s as Y}from"./index-48960f67.js";import{g as Z}from"./user-cf22bde7.js";import{u as ee}from"./consult-66300bb1.js";import{s as ae}from"./function-call-ed82307e.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-b570a55e.js";const ne={key:0,class:"user-page"},oe={class:"user-page"},se={class:"user-page-head"},le={class:"top"},ue={class:"name"},re={class:"user-page-order"},ce={class:"head"},de={class:"user-page-group"},ie=E({__name:"index",setup(pe){J(l=>({d4af3e26:r(N)}));const{t}=q(),T=G(),i=K(),c=f({}),B=async()=>{const l=await Z();c.value=l.data.data},D=[{label:t("user.label1"),path:"/consult"},{label:t("user.label2"),path:"/snake"},{label:t("user.label3"),path:"/patient"},{label:t("user.label4"),path:"/map"}],P=async()=>{await ae({title:"温馨提示",message:"您确认要退出佩吗？",cancelButtonText:"取消",confirmButtonText:"确认"}),i.delUser(),T.push("/login")},R=l=>{T.push(l)},v=f(!1),$=[{name:t("user.avatarText1")},{name:t("user.avatarText2")}],j=l=>{if(l.name==t("user.avatarText1"))k({images:[h.value],showIndex:!1});else{if(!i.avatar.length)return Y(t("user.avatarText4"));if(i.avatar.length==1)return k({images:[i.avatar[i.avatar.length-1]],showIndex:!1});k({images:[i.avatar[i.avatar.length-2]],showIndex:!1})}v.value=!1},F=()=>{v.value=!0},x=f([]),H=async l=>{const p=new FileReader;p.onload=g=>{ee(l.file).then(u=>{localStorage.setItem("avatarUrl",u==null?void 0:u.data.data.url),i.saveAvatar(u==null?void 0:u.data.data.url),h.value=u==null?void 0:u.data.data.url})},p.readAsDataURL(l.file),x.value=[],v.value=!1};I(B);let N=f("20px");I(()=>{var u;const l=window.innerHeight,g=(u=Object.entries({0:"20px",667:"25px",736:"60px",812:"85px",896:"100px",926:"120px"}).find(([w])=>l<=Number(w)))==null?void 0:u.pop();N.value=g||"20px"});let h=f("");return I(()=>{h.value=localStorage.getItem("avatarUrl")||"https://p26-passport.byteacctimg.com/img/user-avatar/3227254b000ad5e103c72b91365dd4a0~90x90.awebp"}),(l,p)=>{const g=d("van-image"),u=d("van-button"),w=d("van-uploader"),L=d("van-action-sheet"),C=d("van-icon"),_=d("van-col"),y=d("van-row"),M=d("router-link"),m=z,b=d("van-badge"),O=d("van-cell");return c.value?(U(),V("div",ne,[a("div",oe,[a("div",se,[a("div",le,[e(g,{round:"",fit:"cover",onClick:F,src:r(h)},null,8,["src"]),e(L,{show:v.value,"onUpdate:show":p[1]||(p[1]=n=>v.value=n),actions:$,onSelect:j},{default:o(()=>[e(w,{modelValue:x.value,"onUpdate:modelValue":p[0]||(p[0]=n=>x.value=n),"after-read":H},{default:o(()=>[e(u,null,{default:o(()=>[A(s(r(t)("user.avatarText3")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"]),a("div",ue,[a("p",null,s(c.value.account),1),a("p",null,[e(C,{name:"edit"})])])]),e(y,null,{default:o(()=>[e(_,{span:"6"},{default:o(()=>[a("p",null,s(c.value.collectionNumber),1),a("p",null,s(r(t)("user.tip1")),1)]),_:1}),e(_,{span:"6"},{default:o(()=>[a("p",null,s(c.value.likeNumber),1),a("p",null,s(r(t)("user.tip2")),1)]),_:1}),e(_,{span:"6"},{default:o(()=>[a("p",null,s(c.value.score),1),a("p",null,s(r(t)("user.tip3")),1)]),_:1}),e(_,{span:"6"},{default:o(()=>[a("p",null,s(c.value.couponNumber),1),a("p",null,s(r(t)("user.tip4")),1)]),_:1})]),_:1})]),a("div",re,[a("div",ce,[a("h3",null,s(l.$t("user.title")),1),e(M,{to:"/"},{default:o(()=>[A(s(r(t)("user.littleTitle"))+" ",1),e(C,{name:"arrow"})]),_:1})]),e(y,null,{default:o(()=>[e(_,{span:"6"},{default:o(()=>{var n;return[e(b,{content:((n=c.value.orderInfo)==null?void 0:n.paidNumber)||""},{default:o(()=>[e(m,{name:"user-paid"})]),_:1},8,["content"]),a("p",null,s(l.$t("user.orderStatus1")),1)]}),_:1}),e(_,{span:"6"},{default:o(()=>{var n;return[e(b,{content:((n=c.value.orderInfo)==null?void 0:n.shippedNumber)||""},{default:o(()=>[e(m,{name:"user-shipped"})]),_:1},8,["content"]),a("p",null,s(r(t)("user.orderStatus2")),1)]}),_:1}),e(_,{span:"6"},{default:o(()=>{var n;return[e(b,{content:((n=c.value.orderInfo)==null?void 0:n.receivedNumber)||""},{default:o(()=>[e(m,{name:"user-received"})]),_:1},8,["content"]),a("p",null,s(r(t)("user.orderStatus3")),1)]}),_:1}),e(_,{span:"6"},{default:o(()=>{var n;return[e(b,{content:((n=c.value.orderInfo)==null?void 0:n.finishedNumber)||""},{default:o(()=>[e(m,{name:"user-finished"})]),_:1},8,["content"]),a("p",null,s(r(t)("user.orderStatus4")),1)]}),_:1})]),_:1})]),a("div",de,[a("h3",null,s(r(t)("user.subTitle")),1),(U(),V(Q,null,W(D,(n,S)=>e(O,{title:n.label,"is-link":"",to:n.path,border:!1,key:S,onClick:_e=>R(n.path)},{icon:o(()=>[e(m,{name:`user-tool-0${S+1}`},null,8,["name"])]),_:2},1032,["title","to","onClick"])),64))]),a("a",{class:"logout",href:"javascript:;",onClick:P},s(r(t)("user.logOut")),1)])])):X("",!0)}}});const we=te(ie,[["__scopeId","data-v-38fa38f6"]]);export{we as default};
