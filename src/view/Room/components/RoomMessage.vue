<script setup lang="ts">
import EvaluateCard from './EvaluateCard.vue'
import { IllnessTime, MsgType } from '@/enums'
import type { Message } from '@/types/room'
import { useShowPrescription } from '@/composable'

const { showPrescription } = useShowPrescription()
defineProps<{ list: Message[] }>()

const timeOptions = [
  { label: '一周内', value: IllnessTime.Week },
  { label: '一月内', value: IllnessTime.Month },
  { label: '半年内', value: IllnessTime.HalfYear },
  { label: '大于半年', value: IllnessTime.More }
]
const flagOptions = [
  { label: '就诊过', value: 0 },
  { label: '没就诊过', value: 1 }
]

const getIllnessTimeText = (time: IllnessTime) => {
  return timeOptions.find((item) => item.value === time)?.label
}

const getConsultFlagText = (flag: 0 | 1) => {
  return flagOptions.find((item) => item.value === flag)?.label
}
</script>

<template>
  <div v-for="{ msgType, msg, createTime, from } in list" :key="createTime">
    <!-- 病情描述 -->
    <div class="msg msg-illness" v-if="msgType === MsgType.CardPat">
      <div class="patient van-hairline--bottom">
        <p>李富贵 男 31岁</p>
        <p>一周内 | 未去医院就诊</p>
      </div>
      <van-row>
        <van-col span="6">病情描述</van-col>
        <van-col span="18">头痛、头晕、恶心</van-col>
        <van-col span="6">图片</van-col>
        <van-col span="18">点击查看</van-col>
      </van-row>
    </div>

    <!-- 温馨提示-通知 -->
    <div class="msg msg-tip" v-if="false">
      <div class="content">
        <span class="green">温馨提示：</span>
        <span>在线咨询不能代替面诊，医护人员建议仅供参考</span>
      </div>
    </div>

    <!-- 通知 -->
    <div class="msg msg-tip" v-if="false">
      <div class="content">
        <span>医护人员正在赶来，请耐心等候</span>
      </div>
    </div>

    <!-- 发消息-文字 -->
    <div class="msg msg-to" v-if="false">
      <div class="content">
        <div class="time">20:12</div>
        <div class="pao">大夫你好？</div>
      </div>
      <van-image src="https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/popular_3.jpg" />
    </div>

    <!-- 发消息-图片 -->
    <div class="msg msg-to" v-if="false">
      <div class="content">
        <div class="time">20:12</div>
        <van-image
          fit="contain"
          src="https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/popular_3.jpg"
        />
      </div>
      <van-image src="https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/popular_3.jpg" />
    </div>

    <!-- 收消息-文字 -->
    <div class="msg msg-from" v-if="false">
      <van-image src="https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/popular_3.jpg" />
      <div class="content">
        <div class="time">20:12</div>
        <div class="pao">哪里不舒服</div>
      </div>
    </div>

    <!-- 收消息-图片 -->
    <div class="msg msg-from" v-if="false">
      <van-image src="https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/popular_3.jpg" />
      <div class="content">
        <div class="time">20:12</div>
        <van-image
          fit="contain"
          src="https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/popular_3.jpg"
        />
      </div>
    </div>

    <!-- 处方消息 -->
    <div class="msg msg-recipe" v-if="false">
      <div class="content">
        <div class="head van-hairline--bottom">
          <div class="head-tit">
            <h3>电子处方</h3>
            <p @click="showPrescription(msg.prescription?.id)">
              原始处方 <van-icon name="arrow"></van-icon>
            </p>
          </div>
          <p>李富贵 男 31岁 血管性头痛</p>
          <p>开方时间：2022-01-15 14:21:42</p>
        </div>
        <div class="body">
          <div class="body-item" v-for="i in 2" :key="i">
            <div class="drug">
              <p>优赛明 维生素E乳</p>
              <p>口服，每次1袋，每天3次，用药3天</p>
            </div>
            <div class="num">x1</div>
          </div>
        </div>
        <div class="foot"><span>购买药品</span></div>
      </div>
    </div>

    <!-- 订单取消 -->
    <div class="msg msg-tip msg-tip-cancel" v-if="false">
      <div class="content">
        <span>订单取消</span>
      </div>
    </div>

    <!-- 评价医生 -->
    <div class="msg msg-comment" v-if="false">
      <evaluate-card />
    </div>
  </div>
</template>

<style lang="scss" scoped>
@import '@/styles/room.scss';
</style>
